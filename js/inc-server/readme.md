# http модуль

функция, которую мы передаем в createServer будт вызываться каждый раз, когда сервер получает запрос


в nodejs предоставляются куча пакетов, которые решают задачи со стримами, файлами, http и тд


в nodejs бекенд и у него один поток, который умеет выполнять какие-то операции. А браузеров, которые делают запросы на наш бекенд много. Бекенд должне максимольно быстро благодаря объекту request понять, что от него хотят и максимально быстро благодаря объекту response отдать ответ. Если мы перед тем как отдать response напишем какую-то программу, которая будет занимать время, то это задержка отразиться на всех запросах со всех клиентов. Ситуацию спасает асинхронность. Благодаря евент лупу все операции, кроме отдать ответ  выполняются вне основного потока. 




# fs модуль 
fs - file system. Модуль, чтобы работать с файлами.

fs.readFileSync(path) - конвертирует(считывает) файл, находящийся по переданному пути в поток байтов (readFile - тоже самое но асинхронно)
Считывание файло - это очень медленная операция. А поток должен заниматься процессорными операциями, а не ждать пока файл считается, поэтому используем асинхронность.


Когда у нас есть асиннхроность у нас всегда есть колбеки, которые будут вызваны в соответствующий момент



# Rest api
RESTful API - спецификация, договоренность, определенные правила по которым мы устанавливаем связь между клиентом и сервером

CRUD 
http методы:
1. post
2. get
3. update
4. delete
5. put - нужно отправить все поля, patch - нужно отправить поля кторые нужно обновить у конкретной структуры (rest так договорились)



бекенд может реагировать на полученный url и http метод, который ему приходит

fetch("http://localhost:3003/api/home/1", {method: "POST", headers: {}, body: {}})

Клиент комбинируя url адрес и метод http запроса может указывать свое намерение, что он хочет. А бекенд может понять чего от него хотя и выполнять 
соответствующую логику реагируя на эти запросы. url - это endpoint

Параметры:
1. uri параметры - основые параметры
2. query параметры - дополнительные параметры запроса (например для получения каких нибудь отфильтрованных пользователей по какому-то полю в их структуре)


Метаданные в запросы (данне о данных):
Заголовки:
1. response headers 


2. request header

content-type - клиент говорит, что за контент отправли на бек. Бек исходя из этого думает как ему это парсить



http статус коды - это тоже договоренность rest api


# express 

1. yarn - это разработка facebook, который оптимизировал npm. C yarn вроде как меньше проблем

1. nodemon - программа, которая следит за файлами и когда файлы меняются перезапускает приложение (сокращение от node monitor)

чтобы запустить локально установленный nodemon нужно прописать yarn nodemon serever.js. Yarn поймет, что nodemon установлен локально и запустит его из папки node modules. Когда устанавливаешь глобально nodemon, то его можно запусить как обычную утилиту из терминала прописав ее имя (nodemon server.js)



отладка - изучение приложения по шагам

yarn nodemon --inspect server.js - поднять вебсокет соединение, к которому может подключить chrome devtools. То есть наш хром может подключиться к движку v8, который запущен в nodejs

метод send:
1. если передать в метод send отбъект, то он под капотом передаст в ответе json
2. если передать строку то отдаст text/html
3. если передать число то отдаст статус код
# typescript

typscript нужен нам для строгой типизации, которая позволяет совершать меньше ошибок. Больше ошибок будут видны а режиме написания кода, то есть на стадии компиляции когда ts компилируется в js. Ошибки во время выполнения программы дороже, так как нам нужно, чтобы программа запустилась и довести программу до той точки,когда она упадет. Чем не более ранней стадии нам подсказывает где ошибка тем лучше.

Некоторые библиотки пишутся сразу на ts, а для других типы пишутся отдельно и определения типов для них нужно дополнительно подтянуть 

Установка typescript:
typescript
@types/express
ts-node - утилита, которая позволяет nodejs запускать ts как-будто бы он js
@types/node - определение типов для функционала, который предоставляет nodejs


Благодаря ts-node можно запускать сервер вот так: yarn nodemon server.ts


Чтобы запустить сервер на typescript в режиме отладки (дебагга) нужно:
1. yarn tsc -w -  запустить ts копмилятор в режиме наблюдения за изменением файлов, он будет следить и перекомпелировать изменившиеся файлы.
2. yarn nodemon --inspect ./dist/server.js - поднять сервер в режиме отладки.

Все это можно дополнительно автоматизировать, настроим конфиг для nodemon

# Основы express

сериализация - перевод структуры данных в битовую последовательность
десериализация -  создание структуры данных из битовой последовательности

есть строковая сериализация (перевод объекта в строку) и бинарная (перевод структуры в битовую последовательности)

используя fetch нужно не забывать сериальизовать body в стоку, иначе будет ошибка


# Вопросы
1. Почему счетчик увеличивается на, а не на 1.